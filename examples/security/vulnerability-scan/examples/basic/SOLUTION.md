# Basic Example - Security Vulnerabilities Guide

This document maps the security vulnerabilities present in the basic example application. This is for reference and training purposes only.

## Vulnerabilities Overview

### 1. Insecure Secret Key

- **Location**: `app.py`, line 6
- **Issue**: Hardcoded development secret key
- **Risk**: High
- **Impact**: Compromised session security, potential session hijacking
- **Fix**: Use a secure random key from environment variables

### 2. SQL Injection

- **Location**: `app.py`, login route
- **Issue**: Unsanitized user input in SQL query
- **Risk**: Critical
- **Impact**: Unauthorized database access, data theft
- **Fix**: Use parameterized queries with cursor.execute()

### 3. Cross-Site Scripting (XSS)

- **Location**: `app.py`, home route
- **Issue**: Unescaped user input in template
- **Risk**: High
- **Impact**: Client-side script injection, session theft
- **Fix**: Use proper template escaping or Flask's render_template()

### 4. Insecure File Upload

- **Location**: `app.py`, upload route
- **Issue**: No file type validation or path sanitization
- **Risk**: High
- **Impact**: Remote code execution, path traversal
- **Fix**: Validate file types, sanitize filenames, use secure_filename()

### 5. Information Disclosure

- **Location**: `app.py`, dashboard route
- **Issue**: Exposing sensitive system information
- **Risk**: Medium
- **Impact**: System information leakage
- **Fix**: Remove debug info or limit to authorized users

### 6. Debug Mode in Production

- **Location**: `app.py`, main block
- **Issue**: Debug mode enabled with public access
- **Risk**: High
- **Impact**: Code execution through debug console
- **Fix**: Disable debug mode in production

### 7. Insecure Database Configuration

- **Location**: `app.py`, init_db function
- **Issue**: No database security configuration
- **Risk**: Medium
- **Impact**: Unauthorized database access
- **Fix**: Use connection pooling, proper permissions

## Secure Implementation Examples

### Secure Secret Key

```python
import os
app.secret_key = os.environ.get('FLASK_SECRET_KEY')
```

### Secure SQL Query

```python
cursor.execute(
    "SELECT * FROM users WHERE username=? AND password=?",
    (username, password)
)
```

### Secure Template Rendering

```python
from flask import render_template
return render_template('home.html', name=name)
```

### Secure File Upload

```python
from werkzeug.utils import secure_filename
filename = secure_filename(file.filename)
if allowed_file(filename):
    file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))
```

### Secure Configuration Display

```python
@login_required
def dashboard():
    return jsonify({
        'app_version': '1.0.0',
        'environment': app.config['ENV']
    })
```

### Production Configuration

```python
if __name__ == '__main__':
    app.run(
        debug=False,
        host='127.0.0.1',
        ssl_context='adhoc'
    )
```

## Testing the Vulnerabilities

This section describes how to verify each vulnerability (for educational purposes only):

1. SQL Injection Test:

   ```
   Username: admin' --
   Password: anything
   ```

2. XSS Test:

   ```
   /?name=<script>alert('xss')</script>
   ```

3. File Upload Test:

   ```
   Try uploading a .php file or using ../../../filename
   ```

4. Information Disclosure:

   ```
   Visit /dashboard and observe system information
   ```

Remember: This information is for educational purposes only. Always practice security testing in controlled environments with proper authorization.
