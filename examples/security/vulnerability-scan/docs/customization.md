# Customizing Security Scans

This guide explains how to customize the security vulnerability scanning process for your specific needs.

## Scan Types

### 1. Full Scan

- Comprehensive analysis of all security aspects
- Includes dependency checking
- Validates configurations
- Examines all code patterns

Generic pattern:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code /path/to/code \
  --recursive \
  \
  -V scan_type=full
```

Ready to run example:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code examples/basic \
  --recursive \
  \
  -V scan_type=full
```

### 2. Quick Scan

- Basic security checks
- Focus on critical vulnerabilities
- Faster execution
- Suitable for CI/CD pipelines

Generic pattern:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code /path/to/code \
  --recursive \
  \
  -V scan_type=quick
```

Ready to run example:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code examples/basic/app.py \
  --recursive \
  \
  -V scan_type=quick
```

### 3. Custom Scan

- Selective rule application
- Focused on specific vulnerability types
- Configurable severity levels

Generic pattern:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code /path/to/code \
  --recursive \
  \
  -J rules='["web","api","auth"]'
```

Ready to run example:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code examples/intermediate/src \
  --recursive \
  \
  -J rules='["web","api","auth"]'
```

## Security Rules

### Available Rule Categories

1. `injection` - SQL, Command, and Code Injection
2. `xss` - Cross-Site Scripting
3. `authentication` - Authentication Issues
4. `authorization` - Authorization Flaws
5. `data-exposure` - Sensitive Data Exposure
6. `configuration` - Security Misconfiguration
7. `dependencies` - Dependency Vulnerabilities
8. `deserialization` - Insecure Deserialization
9. `logging` - Logging and Monitoring Issues

### Applying Specific Rules

Generic pattern:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code /path/to/code \
  --recursive \
  \
  -J rules='["injection","xss","authentication"]'
```

Ready to run example:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code examples/security \
  --recursive \
  \
  -J rules='["injection","xss","authentication"]'
```

## Severity Levels

### Setting Minimum Severity

Generic pattern:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code /path/to/code \
  --recursive \
  \
  -V min_severity=high
```

Ready to run example:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code examples/advanced/services \
  --recursive \
  \
  -V min_severity=high
```

### Available Levels

1. `critical` - Immediate action required
2. `high` - Significant security risk
3. `medium` - Moderate security concern
4. `low` - Minor security issue

## Exclusion Patterns

### Excluding Files and Directories

Generic pattern:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code /path/to/code \
  --recursive \
  \
  -J exclude_patterns='["tests/*","vendor/*"]'
```

Ready to run example:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code examples/advanced \
  --recursive \
  \
  -J exclude_patterns='["tests/*","vendor/*"]'
```

## Output Customization

### JSON Output

Generic pattern:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code /path/to/code \
  --recursive \
  \
  --output-file results.json
```

Ready to run example:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code examples/basic \
  --recursive \
  \
  --output-file basic_scan_results.json
```

### Integrating with CI/CD

#### GitHub Actions

```yaml
- name: Security Scan
  run: |
    ./run.sh \
      --type quick \
      --severity high \
      --rules web,api \
      --output scan-results.json \
      ./src
```

#### GitLab CI

```yaml
security_scan:
  script:
    - ./run.sh --type quick --severity high --output scan-results.json ./src
```

## Advanced Configuration

### Custom Rule Development

1. Define rule patterns in JSON format
2. Specify detection criteria
3. Set severity levels
4. Add remediation guidance

Example custom rule:

```json
{
  "rule_id": "custom_sql_injection",
  "pattern": "execute\\([\"'].*?\\$.*?[\"']\\)",
  "language": "python",
  "severity": "critical",
  "category": "injection",
  "description": "Potential SQL injection detected",
  "remediation": "Use parameterized queries"
}
```

### Scan Profiles

Generic pattern:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code /path/to/code \
  --recursive \
  \
  -V profile=dev
```

Ready to run example:

```bash
ostruct run prompts/task.j2 schemas/scan_result.json \
  --dir code examples/basic \
  --recursive \
  \
  -V profile=dev
```

## Best Practices

1. **Regular Scanning**
   - Integrate with CI/CD pipelines
   - Schedule periodic full scans
   - Scan after major changes

2. **Severity Management**
   - Address critical issues immediately
   - Plan remediation for lower severities
   - Track security debt

3. **False Positive Handling**
   - Document known false positives
   - Use exclusion patterns wisely
   - Regular rule refinement
