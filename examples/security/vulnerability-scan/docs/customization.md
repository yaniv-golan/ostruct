# Customizing Security Scans

This guide explains how to customize the security vulnerability scanning process for your specific needs.

## Scan Types

### 1. Full Scan

- Comprehensive analysis of all security aspects
- Includes dependency checking
- Validates configurations
- Examines all code patterns

```bash
./run.sh --type full /path/to/code
```

### 2. Quick Scan

- Basic security checks
- Focus on critical vulnerabilities
- Faster execution
- Suitable for CI/CD pipelines

```bash
./run.sh --type quick /path/to/code
```

### 3. Custom Scan

- Selective rule application
- Focused on specific vulnerability types
- Configurable severity levels

```bash
./run.sh --type custom --rules web,api,auth /path/to/code
```

## Security Rules

### Available Rule Categories

1. `injection` - SQL, Command, and Code Injection
2. `xss` - Cross-Site Scripting
3. `authentication` - Authentication Issues
4. `authorization` - Authorization Flaws
5. `data-exposure` - Sensitive Data Exposure
6. `configuration` - Security Misconfiguration
7. `dependencies` - Dependency Vulnerabilities
8. `deserialization` - Insecure Deserialization
9. `logging` - Logging and Monitoring Issues

### Applying Specific Rules

```bash
./run.sh --rules injection,xss,authentication /path/to/code
```

## Severity Levels

### Setting Minimum Severity

- Filter out lower severity issues
- Focus on critical security concerns

```bash
./run.sh --severity high /path/to/code
```

### Available Levels

1. `critical` - Immediate action required
2. `high` - Significant security risk
3. `medium` - Moderate security concern
4. `low` - Minor security issue

## Exclusion Patterns

### Excluding Files and Directories

- Skip specific files or patterns
- Useful for generated code or dependencies

```bash
./run.sh --exclude "tests/*,vendor/*" /path/to/code
```

## Output Customization

### JSON Output

- Default structured output
- Machine-readable format
- Follows defined schema

```bash
./run.sh --output results.json /path/to/code
```

### Integrating with CI/CD

#### GitHub Actions

```yaml
- name: Security Scan
  run: |
    ./run.sh \
      --type quick \
      --severity high \
      --rules web,api \
      --output scan-results.json \
      ./src
```

#### GitLab CI

```yaml
security_scan:
  script:
    - ./run.sh --type quick --severity high --output scan-results.json ./src
```

## Advanced Configuration

### Custom Rule Development

1. Define rule patterns in JSON format
2. Specify detection criteria
3. Set severity levels
4. Add remediation guidance

Example custom rule:

```json
{
  "rule_id": "custom_sql_injection",
  "pattern": "execute\\([\"'].*?\\$.*?[\"']\\)",
  "language": "python",
  "severity": "critical",
  "category": "injection",
  "description": "Potential SQL injection detected",
  "remediation": "Use parameterized queries"
}
```

### Scan Profiles

Create reusable scan configurations for different scenarios:

```bash
# Development profile
./run.sh --profile dev /path/to/code

# Production profile
./run.sh --profile prod /path/to/code
```

## Best Practices

1. **Regular Scanning**
   - Integrate with CI/CD pipelines
   - Schedule periodic full scans
   - Scan after major changes

2. **Severity Management**
   - Address critical issues immediately
   - Plan remediation for lower severities
   - Track security debt

3. **False Positive Handling**
   - Document known false positives
   - Use exclusion patterns wisely
   - Regular rule refinement
