Perform a comprehensive security vulnerability scan on the following code:

{% if code_files is defined and code_files %}
Code files to analyze:
{% for file in code_files %}
File: {{ file.path }}
```
{{ file.content }}
```
{% endfor %}
{% endif %}

{% if dependency_files is defined and dependency_files %}
Dependency files to check:
{% for file in dependency_files %}
File: {{ file.path }}
```
{{ file.content }}
```
{% endfor %}
{% endif %}

{% if config_files is defined and config_files %}
Configuration files to validate:
{% for file in config_files %}
File: {{ file.path }}
```
{{ file.content }}
```
{% endfor %}
{% endif %}

Scan Parameters:
- Scan Type: {{ scan_type | default('full') }}
{% if rules is defined and rules %}
- Specific Rules: {{ rules | join(', ') }}
{% endif %}
{% if min_severity is defined and min_severity %}
- Minimum Severity: {{ min_severity }}
{% endif %}
{% if exclude_patterns is defined and exclude_patterns %}
- Exclude Patterns: {{ exclude_patterns | join(', ') }}
{% endif %}

Please analyze the provided code for security vulnerabilities, focusing on:
1. Identifying potential security issues in the application code
2. Checking for known vulnerabilities in dependencies
3. Validating security-related configurations
4. Suggesting specific remediation steps for each issue

Provide your analysis in the following JSON format, adhering to the schema:
{
  "scan_summary": {
    "total_files": <number>,
    "files_with_issues": <number>,
    "total_vulnerabilities": <number>,
    "risk_levels": {
      "critical": <number>,
      "high": <number>,
      "medium": <number>,
      "low": <number>
    }
  },
  "vulnerabilities": [
    {
      "id": "<unique_id>",
      "type": "<vulnerability_type>",
      "risk_level": "<severity>",
      "file_path": "<file_path>",
      "line_number": <line_number>,
      "code_snippet": "<relevant_code>",
      "description": "<detailed_description>",
      "impact": "<potential_impact>",
      "remediation": {
        "suggestion": "<fix_suggestion>",
        "example": "<example_code>"
      },
      "references": [
        "<reference_urls>"
      ]
    }
  ],
  "dependency_issues": [
    {
      "package": "<package_name>",
      "version": "<current_version>",
      "vulnerabilities": [
        {
          "cve": "<cve_id>",
          "severity": "<severity_level>",
          "description": "<vulnerability_description>",
          "fixed_version": "<version_with_fix>"
        }
      ]
    }
  ]
}
