{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": [
        "scan_summary",
        "vulnerabilities"
    ],
    "properties": {
        "scan_summary": {
            "type": "object",
            "required": [
                "total_files",
                "files_with_issues",
                "total_vulnerabilities",
                "risk_levels"
            ],
            "properties": {
                "total_files": {
                    "type": "integer",
                    "description": "Total number of files scanned"
                },
                "files_with_issues": {
                    "type": "integer",
                    "description": "Number of files with identified vulnerabilities"
                },
                "total_vulnerabilities": {
                    "type": "integer",
                    "description": "Total number of vulnerabilities found"
                },
                "risk_levels": {
                    "type": "object",
                    "properties": {
                        "critical": {
                            "type": "integer"
                        },
                        "high": {
                            "type": "integer"
                        },
                        "medium": {
                            "type": "integer"
                        },
                        "low": {
                            "type": "integer"
                        }
                    }
                }
            }
        },
        "vulnerabilities": {
            "type": "array",
            "items": {
                "type": "object",
                "required": [
                    "id",
                    "type",
                    "risk_level",
                    "file_path",
                    "line_number",
                    "description",
                    "remediation"
                ],
                "properties": {
                    "id": {
                        "type": "string",
                        "description": "Unique identifier for the vulnerability"
                    },
                    "type": {
                        "type": "string",
                        "description": "Category of vulnerability (e.g., XSS, SQL Injection)",
                        "enum": [
                            "injection",
                            "xss",
                            "authentication",
                            "authorization",
                            "sensitive_data_exposure",
                            "security_misconfiguration",
                            "dependency_vulnerability",
                            "insecure_deserialization",
                            "logging_issues",
                            "other"
                        ]
                    },
                    "risk_level": {
                        "type": "string",
                        "enum": [
                            "critical",
                            "high",
                            "medium",
                            "low"
                        ]
                    },
                    "file_path": {
                        "type": "string",
                        "description": "Path to the file containing the vulnerability"
                    },
                    "line_number": {
                        "type": "integer",
                        "description": "Line number where the vulnerability was found"
                    },
                    "code_snippet": {
                        "type": "string",
                        "description": "Relevant code snippet showing the vulnerability"
                    },
                    "description": {
                        "type": "string",
                        "description": "Detailed description of the vulnerability"
                    },
                    "impact": {
                        "type": "string",
                        "description": "Potential impact if exploited"
                    },
                    "remediation": {
                        "type": "object",
                        "required": [
                            "suggestion",
                            "example"
                        ],
                        "properties": {
                            "suggestion": {
                                "type": "string",
                                "description": "Suggested fix for the vulnerability"
                            },
                            "example": {
                                "type": "string",
                                "description": "Example of secure implementation"
                            }
                        }
                    },
                    "references": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "description": "URLs to relevant security documentation"
                        }
                    }
                }
            }
        },
        "dependency_issues": {
            "type": "array",
            "items": {
                "type": "object",
                "required": [
                    "package",
                    "version",
                    "vulnerabilities"
                ],
                "properties": {
                    "package": {
                        "type": "string",
                        "description": "Name of the vulnerable package"
                    },
                    "version": {
                        "type": "string",
                        "description": "Current version of the package"
                    },
                    "vulnerabilities": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "required": [
                                "cve",
                                "severity",
                                "description",
                                "fixed_version"
                            ],
                            "properties": {
                                "cve": {
                                    "type": "string",
                                    "description": "CVE identifier"
                                },
                                "severity": {
                                    "type": "string",
                                    "enum": [
                                        "critical",
                                        "high",
                                        "medium",
                                        "low"
                                    ]
                                },
                                "description": {
                                    "type": "string",
                                    "description": "Description of the vulnerability"
                                },
                                "fixed_version": {
                                    "type": "string",
                                    "description": "Version that fixes the vulnerability"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
